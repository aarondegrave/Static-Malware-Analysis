import wget
import requests
from bs4 import BeautifulSoup
import os
import zipfile
import shutil

try:
  os.mkdir('/home/kali/Downloads/test2/')
except FileExistsError:
  print("File exists")
os.chdir('/home/kali/Downloads/test2/')
websites = []
webpages = ['https://mb-api.abuse.ch/downloads/', 'https://das-malwerk.herokuapp.com/']
for webpage in webpages:
  a = requests.get(webpage)
  soup = BeautifulSoup(a.text, 'html.parser')

  for link in soup.findAll('a'):
    c = (link.get('href'))
    realwebsite = webpage + c
    websites.append(realwebsite)

  for website in websites:
    if website.endswith('.zip'):
      wget.download(website)
    else:
      continue

    test = os.listdir('/home/kali/Downloads/test2/')

    for filename in test:
      if filename.endswith('.zip'):
        password = 'infected'
        with zipfile.ZipFile(filename) as file:
          file.extractall(pwd=bytes(password, 'utf-8'))
      try:
        if filename.endswith('.exe') or filename.endswith('.dll'):
          shutil.move(filename, '/home/kali/Downloads/testok/')
      except shutil.Error:
        print("File exists.")




